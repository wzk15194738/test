<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„å…¨èƒ½å®éªŒå®¤ 2.0</title>
    <style>
        /* å…¨å±€ç¾åŒ– */
        :root {
            --primary: #4facfe;
            --bg: #f5f7fa;
            --card: rgba(255, 255, 255, 0.9);
        }
        body { font-family: sans-serif; background: var(--bg); margin: 0; padding: 20px; transition: 0.5s; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto; }
        .card { background: var(--card); padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: 0.3s; }
        .card:hover { transform: translateY(-5px); }
        h3 { margin-top: 0; color: var(--primary); font-size: 0.9rem; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        button { background: var(--primary); border: none; color: white; padding: 8px 15px; border-radius: 5px; cursor: pointer; width: 100%; margin-top: 10px; }
        #weatherDisplay { margin-top: 10px; font-size: 0.9rem; line-height: 1.4; color: #555; }
        
        /* å¤œé—´æ¨¡å¼ */
        body.dark { background: #1a1a2e; color: white; }
        body.dark .card { background: #16213e; color: white; border: 1px solid #0f3460; }
    </style>
</head>
<body>

    <h1 id="mainTitle" style="text-align:center;">æˆ‘çš„äº¤äº’å®éªŒå®¤ ğŸ§ª</h1>

    <div class="grid">
        <div class="card"><h3>1. éšæœºå˜è‰²</h3><button id="colorBtn">å˜æ¢æ ‡é¢˜é¢œè‰²</button></div>
        <div class="card"><h3>2. æ¬¢è¿è¯­</h3><input type="text" id="nameInput" placeholder="è¾“å…¥åå­—..." style="width:90%"><p id="greetText">ä½ å¥½ï¼</p></div>
        <div class="card"><h3>3. ä¸»é¢˜åˆ‡æ¢</h3><button id="themeBtn">æ·±è‰²/æµ…è‰²æ¨¡å¼</button></div>
        <div class="card"><h3>4. è®¡æ•°å™¨</h3><div style="text-align:center;"><button id="minus" style="width:30%">-</button> <span id="count">0</span> <button id="plus" style="width:30%">+</button></div></div>
        
        <div class="card">
            <h3>5. å®æ—¶å¤©æ°” (Fetch API)</h3>
            <p id="weatherDisplay">ç­‰å¾…æŸ¥è¯¢...</p>
            <button id="getWeather">ç‚¹å‡»æŠ“å–çœŸå®å¤©æ°”æ•°æ®</button>
        </div>
    </div>

    <script>
        // è¾…åŠ©å‡½æ•°
        const $ = (id) => document.getElementById(id);

        // 1. å˜è‰²
        $('colorBtn').onclick = () => {
            $('mainTitle').style.color = `hsl(${Math.random()*360}, 70%, 50%)`;
        };

        // 2. æ¬¢è¿è¯­
        $('nameInput').oninput = (e) => {
            $('greetText').innerText = e.target.value ? `ä½ å¥½ï¼Œ${e.target.value}ï¼` : "ä½ å¥½ï¼";
        };

        // 3. ä¸»é¢˜
        $('themeBtn').onclick = () => document.body.classList.toggle('dark');

        // 4. è®¡æ•°å™¨
        let num = 0;
        $('plus').onclick = () => $('count').innerText = ++num;
        $('minus').onclick = () => $('count').innerText = --num;

        // 5. ã€æ ¸å¿ƒã€‘å¤©æ°” API é€»è¾‘
        $('getWeather').onclick = function() {
            const display = $('weatherDisplay');
            display.innerText = "ğŸ›°ï¸ æ­£åœ¨è¿æ¥æ°”è±¡å«æ˜Ÿ...";

            // ä½¿ç”¨ fetch ä»å¤–éƒ¨æœåŠ¡å™¨è·å–æ•°æ®
            fetch('https://wttr.in/?format=j1')
                .then(res => res.json()) // å°†è¿”å›çš„æ•°æ®è½¬ä¸º JSON æ ¼å¼
                .then(data => {
                    const current = data.current_condition[0];
                    const area = data.nearest_area[0];
                    
                    const temp = current.temp_C; // æ‘„æ°åº¦
                    const desc = current.lang_zh ? current.lang_zh[0].value : current.weatherDesc[0].value; // å¤©æ°”æè¿°
                    const city = area.region[0].value; // åœ°åŒº

                    // æ›´æ–° UI
                    display.innerHTML = `
                        <b>åŸå¸‚ï¼š</b> ${city}<br>
                        <b>æ¸©åº¦ï¼š</b> ${temp}Â°C<br>
                        <b>çŠ¶å†µï¼š</b> ${desc}
                    `;
                    
                    // é¢å¤–é€»è¾‘ï¼šæ ¹æ®æ¸©åº¦æ”¹å˜æ ‡é¢˜é¢œè‰²
                    if (parseInt(temp) > 25) {
                        $('mainTitle').style.color = 'orange';
                    } else {
                        $('mainTitle').style.color = 'skyblue';
                    }
                })
                .catch(err => {
                    display.innerText = "âŒ è·å–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨åå†è¯•ã€‚";
                    console.error(err);
                });
        };
    </script>
</body>
</html>